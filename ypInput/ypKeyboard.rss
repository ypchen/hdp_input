<?xml version='1.0' encoding="UTF-8" ?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/">

<!-- 此 rss 檔是由 media translate 的 keyboard.rss password.rss 修改而來 -->
<!-- 注音表資料來自於 http://sourceforge.net/projects/cce2k/ -->
<!-- Unicode 正體轉簡體程式來自於 http://www.php5.idv.tw/sample/dbcconv.zip -->
<mediaDisplay name="photoView"
	rowCount="4"
	columnCount="12"
	drawItemText="yes"
	menuBorderColor="0:0:0"
	sideColorBottom="0:0:0"
	sideColorTop="0:0:0"
	fontSize="22"
	sideTopHeightPC="0"
	itemImageXPC="10"
	itemOffsetXPC="11"
	itemOffsetYPC="30"
	itemWidthPC="5.5"
	itemHeightPC="10"
	backgroundColor="0:0:0"
	sliding="no"
	showHeader="no"
	showDefaultInfo="no"
	rollItems="no"
	idleImageXPC="45"
	idleImageYPC="42"
	idleImageWidthPC="10"
	idleImageHeightPC="10"
	imageBorderPC="2"
>
	<idleImage>image/busy1.png</idleImage>
	<idleImage>image/busy2.png</idleImage>
	<idleImage>image/busy3.png</idleImage>
	<idleImage>image/busy4.png</idleImage>
	<idleImage>image/busy5.png</idleImage>
	<idleImage>image/busy6.png</idleImage>
	<idleImage>image/busy7.png</idleImage>
	<idleImage>image/busy8.png</idleImage>

	<text redraw="no" align="left"
		offsetXPC="5" offsetYPC="0"
		widthPC="90" heightPC="15"
		fontSize="30"
		backgroundColor="-1:-1:-1" foregroundColor="200:200:200">
		<script>
			getPageInfo("pageTitle") + inputMethod + specialMsg;
		</script>
	</text>

	<image
		offsetXPC="82" offsetYPC="3"
		widthPC="15" heightPC="10">
		<widthPC>
			<script>
				300 / 152 * 10 * screenYp / screenXp;
			</script>
		</widthPC>
		<offsetXPC>
			<script>
				95 - 300 / 152 * 10 * screenYp / screenXp;
			</script>
		</offsetXPC>
	</image>

	<text redraw="yes" align="left"
		offsetXPC="10" offsetYPC="18"
		widthPC="80" heightPC="8"
		fontSize="18"
		backgroundColor="28:35:51" foregroundColor="200:200:200">
		<script>
			if (isPasswordMode == 1) {
				if(inputTextCount &gt; 0) {
					inputPassword="";
					counter = 0;
					while(1) {
						if(counter &gt;= inputTextCount)
							break;
						inputPassword += "*";
						counter += 1;
					}
					if (PHinputTextCount &gt; 0)
						print(inputPassword + "_  {注音: " + PHinputText + "_}");
					else
						print(inputPassword + "_");
				}
				else {
					print("_");
				}
			}
			else {
				if (PHinputTextCount &gt; 0)
					print(inputText + "_  {注音: " + PHinputText + "_}");
				else
					print(inputText + "_");
			}
		</script>
		<foregroundColor>
			<script>
				if (firstUse == 1) "80:80:80";
				else "200:200:200";
			</script>
		</foregroundColor>
	</text>

	<text redraw="no" align="left"
		offsetXPC="10" offsetYPC="80"
		widthPC="80" heightPC="5"
		fontSize="16"
		backgroundColor="-1:-1:-1" foregroundColor="140:140:140">
		[數字鍵]輸入數字; [下頁]輸入空格; [上頁]刪除字元; [播放]完成全部輸入並送出
	</text>

	<text redraw="no" align="left"
		offsetXPC="10" offsetYPC="85"
		widthPC="80" heightPC="5"
		fontSize="16"
		backgroundColor="-1:-1:-1" foregroundColor="140:140:140">
		[信息(大小注)]切換大小寫與輸入法; [選時(Go)]完成一個字; [重覆]重覆上個字(元)
	</text>

	<itemDisplay>
		<text align="center"
			offsetXPC="0" offsetYPC="0"
			widthPC="100" heightPC="100"
			fontSize="22"
			backgroundColor="33:40:58" foregroundColor="200:200:200">
			<script>
				idx = getQueryItemIndex();
				getStringArrayAt(itemTitleArray, idx-(-1));
			</script>
		</text>
	</itemDisplay>

	<onUserInput>
		<script>
			specialMsg = "";

			ret = "false";
			inputNumber = null;
			userInput = currentUserInput();

			if (userInput == "one" || userInput == "1")
				inputNumber = "1";
			else if (userInput == "two" || userInput == "2")
				inputNumber = "2";
			else if (userInput == "three" || userInput == "3")
				inputNumber = "3";
			else if (userInput == "four" || userInput == "4")
				inputNumber = "4";
			else if (userInput == "five" || userInput == "5")
				inputNumber = "5";
			else if (userInput == "six" || userInput == "6")
				inputNumber = "6";
			else if (userInput == "seven" || userInput == "7")
				inputNumber = "7";
			else if (userInput == "eight" || userInput == "8")
				inputNumber = "8";
			else if (userInput == "nine" || userInput == "9")
				inputNumber = "9";
			else if (userInput == "zero" || userInput == "0")
				inputNumber = "0";
			else if (userInput == "pagedown" || userInput == "PD")
				inputNumber = " ";
			else if (userInput == "video_repeat")
				inputNumber = lastItemTitle;
			else if (userInput == "pageup" || userInput == "PG") {
				firstUse = 0;
				if (PHinputTextCount &gt; 0) {
					PHinputTextCount -= 1;
					PHinputTextArray = deleteStringArrayAt(PHinputTextArray, PHinputTextCount);
					PHinputText = "";
					counter = 0;
					while(1) {
						if(counter &gt;= PHinputTextCount)
							break;
						PHinputText += getStringArrayAt(PHinputTextArray, counter);
						counter += 1;
					}
					redrawDisplay();
				}
				else if (inputTextCount &gt; 0) {
					inputTextCount -= 1;
					inputTextArray = deleteStringArrayAt(inputTextArray, inputTextCount);
					inputText = "";
					counter = 0;
					while(1) {
						if(counter &gt;= inputTextCount)
							break;
						inputText += getStringArrayAt(inputTextArray, counter);
						counter += 1;
					}
					redrawDisplay();
				}
				ret = "true";
			}
			else if(userInput == "video_play") {
				if (isPasswordMode != 1) {
					saveString = null;
					saveString = pushBackStringArray(saveString, inputTextCount);
					saveString = pushBackStringArray(saveString, inputTextArray);
					writeStringToFile(getStoragePath("tmp")+"ypKeyboar.saveString.dat", saveString);
				}
				setReturnString(inputText);
				postMessage("return");
				ret = "true";
			}
			else if (userInput == "display") {
				PHinputTextCount = 0;
				PHinputTextArray = null;
				PHinputText = "";

				if (currentPage == 1) {
					currentPage    = 2;
					itemTitleArray = itemTitleArrayP2;
					/* Fixed itemSize for the static 4 pages */
					itemSize        = 48;
					inputMethod     = " [大寫]";
				}
				else if (currentPage == 2) {
					currentPage    = 3;
					itemTitleArray = itemTitleArrayP3;
					/* Fixed itemSize for the static 4 pages */
					itemSize        = 48;
					inputMethod     = " [正體]";
				}
				else if (currentPage == 3) {
					currentPage    = 4;
					itemTitleArray = itemTitleArrayP4;
					/* Fixed itemSize for the static 4 pages */
					itemSize        = 48;
					inputMethod     = " [簡體]";
				}
				else if (currentPage == 4) {
					currentPage    = 1;
					itemTitleArray = itemTitleArrayP1;
					/* Fixed itemSize for the static 4 pages */
					itemSize        = 48;
					inputMethod     = " [小寫]";
				}

				redrawDisplay();
				ret = "true";
			}
			else if ((userInput == "video_search") &amp;&amp; (PHinputTextCount &gt; 0)) {

				if (currentPage == 3)
					fileChar = "./etc/ypInput/ypPhoneticCHT/i=" + PHinputText + ".str";
				else if (currentPage == 4)
					fileChar = "./etc/ypInput/ypPhoneticCHS/i=" + PHinputText + ".str";

				itemTitleArrayChar = readStringFromFile(fileChar);
				if (itemTitleArrayChar != null) {
					prevPage           = currentPage;
					prevItemTitleArray = itemTitleArray;
					prevInputMethod    = inputMethod;
					currentPage        = 0;
					itemTitleArray     = itemTitleArrayChar;
					itemSize           = getStringArrayAt(itemTitleArray, 0);
				}
				else {
					specialMsg = " -- 無此字";
				}
				redrawDisplay();
				ret = "true";
			}

			if (inputNumber != null) {
				if(firstUse == 1) {
					if(inputNumber == " ")
						inputNumber = "";
					else {
						inputText = "";
						inputTextArray = null;
						inputTextCount = 0;
					}
					firstUse = 0;
					redrawDisplay();
				}
				if(inputNumber != "") {
					inputText += inputNumber;
					inputTextArray  = pushBackStringArray(inputTextArray, inputNumber);
					inputTextCount -= -1;
					redrawDisplay();
					ret = "true";
				}
			}
			ret;
		</script>
	</onUserInput>
</mediaDisplay>

<onEnter>
	isPasswordMode = 0;

	specialMsg = "";

	screenXp = 4;
	screenYp = 3;

	itemTitleArrayP1 = readStringFromFile("./etc/ypInput/ypDictionary_p1.str");
	itemTitleArrayP2 = readStringFromFile("./etc/ypInput/ypDictionary_p2.str");
	itemTitleArrayP3 = readStringFromFile("./etc/ypInput/ypDictionary_p3.str");
	itemTitleArrayP4 = readStringFromFile("./etc/ypInput/ypDictionary_p4.str");

	prevPage           = 0;
	prevItemTitleArray = null;
	prevInputMethod    = "";

	currentPage      = 1;
	itemTitleArray   = itemTitleArrayP1;
	/* Fixed itemSize for the static 3 pages */
	itemSize         = 48;
	inputMethod     = " [小寫]";

	lastItemTitle    = "";

	inputTextCount = 0;
	inputTextArray = null;
	inputText = "";

	PHinputTextCount = 0;
	PHinputTextArray = null;
	PHinputText = "";

	saveString=null;
	if(isPasswordMode != 1){
		saveString = readStringFromFile(getStoragePath("tmp")+"ypKeyboar.saveString.dat");
		if(saveString != null) {
			inputTextCount = getStringArrayAt(saveString, 0);
			counter = 0;
			while(1) {
				if(counter &gt;= inputTextCount)
					break;
				ch = getStringArrayAt(saveString, counter+1);
				inputText += ch;
				inputTextArray = pushBackStringArray(inputTextArray, ch);
				counter += 1;
			}
		}
	}

	firstUse = 0;
	if(inputText != "") firstUse = 1;
	setFocusItemIndex(0);
	redrawDisplay();
</onEnter>

<item_template>
	<onClick>
		idx = getFocusItemIndex();
		itemTitle = getStringArrayAt(itemTitleArray, idx-(-1));

		if (itemTitle == "小") {
			currentPage    = 1;
			itemTitleArray = itemTitleArrayP1;
			/* Fixed itemSize for the static 4 pages */
			itemSize       = 48;
			inputMethod     = " [小寫]";

			PHinputTextCount = 0;
			PHinputTextArray = null;
			PHinputText = "";
		}
		else if (itemTitle == "大") {
			currentPage    = 2;
			itemTitleArray = itemTitleArrayP2;
			/* Fixed itemSize for the static 4 pages */
			itemSize       = 48;
			inputMethod     = " [大寫]";

			PHinputTextCount = 0;
			PHinputTextArray = null;
			PHinputText = "";
		}
		else if (itemTitle == "正") {
			currentPage    = 3;
			itemTitleArray = itemTitleArrayP3;
			/* Fixed itemSize for the static 4 pages */
			itemSize       = 48;
			inputMethod     = " [正體]";

			PHinputTextCount = 0;
			PHinputTextArray = null;
			PHinputText = "";
		}
		else if (itemTitle == "簡") {
			currentPage    = 4;
			itemTitleArray = itemTitleArrayP4;
			/* Fixed itemSize for the static 4 pages */
			itemSize       = 48;
			inputMethod     = " [簡體]";

			PHinputTextCount = 0;
			PHinputTextArray = null;
			PHinputText = "";
		}
		else {
			if (firstUse == 1) {
				inputText = "";
				inputTextArray = null;
				inputTextCount = 0;
				firstUse = 0;
			}

			if ((currentPage == 0) || (currentPage == 1) || (currentPage == 2)){
				inputText += itemTitle;
				inputTextArray  = pushBackStringArray(inputTextArray, itemTitle);
				inputTextCount -= -1;

				lastItemTitle = itemTitle;
			}
			else if ((itemTitle != "") &amp;&amp; (itemTitle != "Go")) {
				PHinputText += itemTitle;
				PHinputTextArray  = pushBackStringArray(PHinputTextArray, itemTitle);
				PHinputTextCount -= -1;
			}
		}

		if (currentPage == 0) {
			currentPage    = prevPage;
			itemTitleArray = prevItemTitleArray;
			inputMethod    = prevInputMethod;
			/* Fixed itemSize for the static 4 pages */
			itemSize       = 48;

			PHinputTextCount = 0;
			PHinputTextArray = null;
			PHinputText = "";
		}
		else if (((currentPage == 3) || (currentPage == 4)) &amp;&amp; (PHinputTextCount &gt; 0) &amp;&amp;
			((itemTitle == "Go") || (itemTitle == "ˇ") || (itemTitle == "ˋ") || (itemTitle == "ˊ") || (itemTitle == "˙"))) {

			if (currentPage == 3)
				fileChar = "./etc/ypInput/ypPhoneticCHT/i=" + PHinputText + ".str";
			else if (currentPage == 4)
				fileChar = "./etc/ypInput/ypPhoneticCHS/i=" + PHinputText + ".str";

			itemTitleArrayChar = readStringFromFile(fileChar);
			if (itemTitleArrayChar != null) {
				prevPage           = currentPage;
				prevItemTitleArray = itemTitleArray;
				prevInputMethod    = inputMethod;
				currentPage        = 0;
				itemTitleArray     = itemTitleArrayChar;
				itemSize           = getStringArrayAt(itemTitleArray, 0);
			}
			else {
				specialMsg = " -- 無此字";
			}
		}

		redrawDisplay();
		null;
	</onClick>
</item_template>

<channel>

	<title>字串輸入</title>

	<itemSize>
		<script>
			itemSize;
		</script>
	</itemSize>
</channel>

</rss>
